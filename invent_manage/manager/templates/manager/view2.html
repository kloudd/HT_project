{% extends "manager/index.html" %}
{% block nav-view %}
class="active"
{% endblock %}
{% block for_view %}
<div class="container-fluid">
	<div id="pageTab" class="row-fluid">
		<div class="well">
			<ul class="nav nav-pills">
				<li><a href="#page1"  data-toggle="tab">system config</a>
				</li>
				<li><a href="#page2"  data-toggle="tab">System INFO</a>
				</li>
				<li><a href="#page3"  data-toggle="tab">Warranty details</a>
				</li>
			</ul>
			<a class = "btn btn-info" href="{% url 'exp' %}">Export to .xls ( working )</a>
			&nbsp;
			<a class = "btn btn-info" href="{% url 'add' %}"><i class="icon-plus"></i>Add Online Record</a>
		</div>
	</div>
</div>
<div class="well">
	<div class="tab-content">
		<div id="page1" class="tab-pane">
			<table class="table table-bordered table-hover sortable">
				<thead> 
					<tr>
						<td></td>
						<td></td>
						<th data-defaultsort="asc" data-sortkey="0"><span class="btn">ID</span></th>
						<th data-defaultsort="asc"><span class="btn">UID</span></th>
						<th data-defaultsort="asc"><span class="btn">MACHINE</span></th>
						<th data-defaultsort="asc"><span class="btn">DEPARTMENT</span></th>
						<th data-defaultsort="asc"><span class="btn">MODEL</span></th>
						<th data-defaultsort="asc"><span class="btn">S NO.</span></th>
						<th data-defaultsort="asc"><span class="btn">PROCESSOR</span></th>
						<th data-defaultsort="asc"><span class="btn">RAM</span></th>
						<th data-defaultsort="asc"><span class="btn">HDD</span></th>
						<th data-defaultsort="asc"><span class="btn">OS</span></th>
						<th data-defaultsort="asc"><span class="btn">RAM&nbsp;DATE</span></th>
						<th data-defaultsort="asc"><span class="btn">HDD&nbsp;DATE</span></th>
					</tr>
				</thead>
				<tbody>
					{% if orderby %}
					{% for poll in orderby %}
					{% ifequal poll.working 1 %}
					<!-- {% if poll.uid or poll.machinename or poll.department or poll.model_name or poll.s_no %} style="color:#C00" {%endif%} -->
					<tr>
						<td data-value="{{poll.id}}"><a class="btn btn-small btn-info" href="edit/{{poll.id}}"><i class="icon-edit"></i></a></td>
						<td data-value="{{poll.id}}"><a class="btn btn-small btn-warning" href="delete/{{poll.id}}"><i class="icon-trash"></i></a></td>
						<td data-value="{{poll.id}}">{{ poll.id }}</td>
						<td data-value="{{poll.uid}}">{{ poll.uid }}</td>
						<td data-value="{{poll.machinename}}">{{ poll.machinename }}</td>
						<td data-value="{{poll.department}}">{{ poll.department }}</td>
						<td data-value="{{poll.model_name}}">{{ poll.model_name }}</td>
						<td data-value="{{poll.s_no}}">{{ poll.s_no }}</td>
						<td data-value="{{poll.processor}}">{{ poll.processor }}</td>
						<td data-value="{{poll.ram}}">{{ poll.ram }}</td>
						<td data-value="{{poll.hdd}}">{{ poll.hdd }}</td>
						<td data-value="{{poll.os}}">{{ poll.os }}</td>
						<td data-value="{{poll.ram_change_date}}">{{ poll.ram_change_date }}</td>
						<td data-value="{{poll.hdd_change_date}}">{{ poll.hdd_change_date }}</td>
					</tr>
					{% endifequal %}
					{% endfor %}
					{% else %}
					<p>NO RECORDS AVAILABLE</p>
					{% endif %}
				</tbody>

			</table>
		</div>
		<div id="page2" class="tab-pane">
			<table class="table table-bordered table-hover sortable">
				<thead>
					<tr>
						<td></td>
						<td></td>
						<th data-defaultsort="asc" data-sortkey="0"><span class="btn">ID</span></th>
						<th><span class="btn">UID</span></th>
						<th><span class="btn">ASSET&nbsp;CODE</span></th>
						<th><span class="btn">ASSET&nbsp;CATEGORY</span></th>
						<th><span class="btn">REGION</span></th>
						<th><span class="btn">UNIT</span></th>
						<th><span class="btn">LOCATION</span></th>
						<th><span class="btn">FLOOR</span></th>
						<th><span class="btn">USER NAME</span></th>
						<th><span class="btn">EMP&nbsp;CODE</span></th>
						<th><span class="btn">DESIGNATION</span></th>			
					</tr>
				</thead>
				<tbody>
					{% if orderby %}
					{% for poll in orderby %}
					{% ifequal poll.working 1 %}
					<tr>
						<td data-value="{{poll.id}}"><a class="btn btn-small btn-info" href="edit/{{poll.id}}"><i class="icon-edit"></i></a></td>
						<td data-value="{{poll.id}}"><a class="btn btn-small btn-warning" href="delete/{{poll.id}}"><i class="icon-trash"></i></a></td>
						<td data-value="{{poll.id}}">{{ poll.id }}</td>
						<td data-value="{{poll.uid}}">{{ poll.uid }}</td>
						<td data-value="{{poll.asset_code}}">{{ poll.asset_code }}</td>
						<td data-value="{{poll.asset_category}}">{{ poll.asset_category }}</td>
						<td data-value="{{poll.region}}">{{ poll.region }}</td>
						<td data-value="{{poll.unit}}">{{ poll.unit }}</td>
						<td data-value="{{poll.location}}">{{ poll.location }}</td>
						<td data-value="{{poll.floor}}">{{ poll.floor }}</td>
						<td data-value="{{poll.username}}">{{ poll.username }}</td>
						<td data-value="{{poll.empcode}}">{{ poll.empcode }}</td>
						<td data-value="{{poll.designation}}">{{ poll.designation }}</td>
					</tr>
					{% endifequal %}
					{% endfor %}
					{% else %}
					<p>NO RECORDS AVAILABLE</p>
					{% endif %}
				</tbody>

			</table>
		</div>
		<div id="page3" class="tab-pane">
			<table class="table table-bordered table-hover sortable">
				<thead>
					<tr>
						<td></td>
						<td></td>
						<th data-defaultsort="asc" data-sortkey="0"><span class="btn">ID</span></th>
						<th><span class="btn">UID</span></th>
						<th><span class="btn">ROLE</span></th>
						<th><span class="btn">AMC</span></th>
						<th><span class="btn">VENDOR</span></th>
						<th><span class="btn">START DATE</span></th>
						<th><span class="btn">EXP DATE</span></th>
						<th><span class="btn">COMPANY</span></th>
						<th><span class="btn">PO DETAILS</span></th>
					</tr>
				</thead>
				<tbody>
					{% if orderby %}
					{% for poll in orderby %}
					{% ifequal poll.working 1 %}
					<tr>
						<td data-value="{{poll.id}}"><a class="btn btn-small btn-info" href="edit/{{poll.id}}"><i class="icon-edit"></i></a></td>
						<td data-value="{{poll.id}}"><a class="btn btn-small btn-warning" href="delete/{{poll.id}}"><i class="icon-trash"></i></a></td>
						<td data-value="{{poll.id}}">{{ poll.id }}</td>
						<td data-value="{{poll.uid}}">{{ poll.uid }}</td>
						<td data-value="{{poll.role}}">{{ poll.role }}</td>
						<td data-value="{{poll.warr_amc}}">{{ poll.warr_amc }}</td>
						<td data-value="{{poll.warr_vend}}">{{ poll.warr_vend }}</td>
						<td data-value="{{poll.warr_start_date}}">{{ poll.warr_start_date }}</td>
						<td data-value="{{poll.warr_exp_date}}">{{ poll.warr_exp_date }}</td>
						<td data-value="{{poll.company}}">{{ poll.company }}</td>
						<td data-value="{{poll.po_details}}">{{ poll.po_details }}</td>
					</tr>
					{% endifequal %}
					{% endfor %}
					{% else %}
					<p>NO RECORDS AVAILABLE</p>
					{% endif %}
				</tbody>
			</div>
		</div>
	</div>
</div>
<script>
$(function () {
	$('#pageTab a:first').tab('show');
})
</script>
  <script type="text/javascript">
  /* TINY SORT modified according to this https://github.com/Sjeiti/TinySort/pull/51*/
(function (e, t) { function h(e) { return e && e.toLowerCase ? e.toLowerCase() : e } function p(e, t) { for (var r = 0, i = e.length; r < i; r++) if (e[r] == t) return !n; return n } var n = !1, r = null, i = parseFloat, s = Math.min, o = /(-?\d+\.?\d*)$/g, u = /(\d+\.?\d*)$/g, a = [], f = [], l = function (e) { return typeof e == "string" }, c = Array.prototype.indexOf || function (e) { var t = this.length, n = Number(arguments[1]) || 0; n = n < 0 ? Math.ceil(n) : Math.floor(n); if (n < 0) n += t; for (; n < t; n++) { if (n in this && this[n] === e) return n } return -1 }; e.tinysort = { id: "TinySort", version: "1.5.2", copyright: "Copyright (c) 2008-2013 Ron Valstar", uri: "http://tinysort.sjeiti.com/", licensed: { MIT: "http://www.opensource.org/licenses/mit-license.php", GPL: "http://www.gnu.org/licenses/gpl.html" }, plugin: function () { var e = function (e, t) { a.push(e); f.push(t) }; e.indexOf = c; return e }(), defaults: { order: "asc", attr: r, data: r, useVal: n, place: "start", returns: n, cases: n, forceStrings: n, ignoreDashes: n, sortFunction: r } }; e.fn.extend({ tinysort: function () { var d, v, m = this, g = [], y = [], b = [], w = [], E = 0, S, x = [], T = [], N = function (t) { e.each(a, function (e, n) { n.call(n, t) }) }, C = function (t, r) { var s = 0; if (E !== 0) E = 0; while (s === 0 && E < S) { var a = w[E], c = a.oSettings, p = c.ignoreDashes ? u : o; N(c); if (c.sortFunction) { s = c.sortFunction(t, r) } else if (c.order == "rand") { s = Math.random() < .5 ? 1 : -1 } else { var d = n, v = !c.cases ? h(t.s[E]) : t.s[E], m = !c.cases ? h(r.s[E]) : r.s[E]; v = v.replace(/^\s*/i, "").replace(/\s*$/i, ""); m = m.replace(/^\s*/i, "").replace(/\s*$/i, ""); if (!A.forceStrings) { var g = l(v) ? v && v.match(p) : n, y = l(m) ? m && m.match(p) : n; if (g && y) { var b = v.substr(0, v.length - g[0].length), x = m.substr(0, m.length - y[0].length); if (b == x) { d = !n; v = i(g[0]); m = i(y[0]) } } } s = a.iAsc * (v < m ? -1 : v > m ? 1 : 0) } e.each(f, function (e, t) { s = t.call(t, d, v, m, s) }); if (s === 0) E++ } return s }; for (d = 0, v = arguments.length; d < v; d++) { var k = arguments[d]; if (l(k)) { if (x.push(k) - 1 > T.length) T.length = x.length - 1 } else { if (T.push(k) > x.length) x.length = T.length } } if (x.length > T.length) T.length = x.length; S = x.length; if (S === 0) { S = x.length = 1; T.push({}) } for (d = 0, v = S; d < v; d++) { var L = x[d], A = e.extend({}, e.tinysort.defaults, T[d]), O = !(!L || L == ""), M = O && L[0] == ":"; w.push({ sFind: L, oSettings: A, bFind: O, bAttr: !(A.attr === r || A.attr == ""), bData: A.data !== r, bFilter: M, $Filter: M ? m.filter(L) : m, fnSort: A.sortFunction, iAsc: A.order == "asc" ? 1 : -1 }) } m.each(function (n, r) { var i = e(r), s = i.parent().get(0), o, u = []; for (j = 0; j < S; j++) { var a = w[j], f = a.bFind ? a.bFilter ? a.$Filter.filter(r) : i.find(a.sFind) : i; u.push(a.bData ? f.data(a.oSettings.data) : a.bAttr ? f.attr(a.oSettings.attr) : a.oSettings.useVal ? f.val() : f.text()); if (o === t) o = f } var l = c.call(b, s); if (l < 0) { l = b.push(s) - 1; y[l] = { s: [], n: [] } } if (o.length > 0) y[l].s.push({ s: u, e: i, n: n }); else y[l].n.push({ e: i, n: n }) }); e.each(y, function (e, t) { t.s.sort(C) }); e.each(y, function (t, r) { var i = r.s.length, o = [], u = i, a = [0, 0]; switch (A.place) { case "first": e.each(r.s, function (e, t) { u = s(u, t.n) }); break; case "org": e.each(r.s, function (e, t) { o.push(t.n) }); break; case "end": u = r.n.length; break; default: u = 0 } for (d = 0; d < i; d++) { var f = p(o, d) ? !n : d >= u && d < u + r.s.length, l = (f ? r.s : r.n)[a[f ? 0 : 1]].e; l.parent().append(l); if (f || !A.returns) g.push(l.get(0)); a[f ? 0 : 1]++ } }); m.length = 0; Array.prototype.push.apply(m, g); return m } }); e.fn.TinySort = e.fn.Tinysort = e.fn.tsort = e.fn.tinysort })(jQuery);

(function ($) {

  var $document = $(document),
        bsSort = [],
      lastSort;

  $.bootstrapSortable = function (applyLast) {
    // set attributes needed for sorting
    $('table.sortable').each(function () {
      var $this = $(this);
      applyLast = (applyLast === true);
      $this.find('span.arrow').remove();
      $this.find('thead th').each(function (index) {
        $(this).attr('data-sortkey', index);
      });
      $this.find('th,td').each(function () {
        var $this = $(this);
        $this.attr('data-value') === undefined && $this.attr('data-value', $this.text());
      });
      $this.find('thead th').each(function (index) {
        var $this = $(this);
        lastSort = applyLast ? lastSort : -1;
        bsSort[index] = applyLast ? bsSort[index] : $this.attr('data-defaultsort');
        if (bsSort[index] != null && (applyLast == (index == lastSort))) {
          bsSort[index] = bsSort[index] == 'asc' ? 'desc' : 'asc';
          $this.click();
        }
      });
    });
  };

  // add click event to table header
  $document.on('click', 'table.sortable thead th', function (e) {
    var $this = $(this), $table = $this.parents('table.sortable');

    // update arrow icon
    if ($.browser.mozilla) {
      var moz_arrow = $table.find('div.mozilla');
      if (moz_arrow != null) {
        moz_arrow.parent().html(moz_arrow.text());
      }
      $this.wrapInner('<div class="mozilla"></div>');
      $this.children().eq(0).append('<span class="arrow"></span>');
    }
    else {
      $table.find('span.arrow').remove();
      $this.append('<span class="arrow"></span>');
    }

    // sort direction
    var nr = $this.attr('data-sortkey');
    lastSort = nr;
    bsSort[nr] = bsSort[nr] == 'asc' ? 'desc' : 'asc';
    if (bsSort[nr] == 'desc') { $this.find('span.arrow').addClass('up'); }

    // sort rows
    var rows = $table.find('tbody tr');
    rows.tsort('td:eq(' + nr + ')', { order: bsSort[nr], attr: 'data-value' });
  });

  // jQuery 1.9 removed this object
  if (!$.browser) {
    $.browser = { chrome: false, mozilla: false, opera: false, msie: false, safari: false };
    var ua = navigator.userAgent;
    $.each($.browser, function (c, a) {
      $.browser[c] = ((new RegExp(c, 'i').test(ua))) ? true : false;
      if ($.browser.mozilla && c == 'mozilla') { $.browser.mozilla = ((new RegExp('firefox', 'i').test(ua))) ? true : false; };
      if ($.browser.chrome && c == 'safari') { $.browser.safari = false; };
    });
  };

  // Initialise on DOM ready
  $($.bootstrapSortable);

}(jQuery));
</script>
{% endblock %}